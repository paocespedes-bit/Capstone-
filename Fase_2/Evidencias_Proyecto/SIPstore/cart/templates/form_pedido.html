{% load static %}
<div class="collapse" id="checkoutFormCollapse">
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-success text-white">
            <h5 class="mb-0">Información de Pedido y Cliente</h5>
        </div>
        <div class="card-body">
            <form id="pedidoForm" method="POST" action="{% url 'crear_pedido' %}">
                {% csrf_token %}

                <!-- Información del Pedido -->
                <fieldset class="mb-4 p-3 border rounded">
                    <legend class="float-none w-auto px-2 fs-6 text-success">Información Pedido</legend>
                    <div class="mb-3">
                        <label for="localSelect" class="form-label">Local de Retiro</label>
                        <select name="localSelect" class="form-select" id="localSelect" required>
                            <option value="" selected disabled>Selecciona un local...</option>
                            {% for local in locales %}
                            <option value="{{ local.id }}">{{ local.nombre }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </fieldset>

                <!-- Método de Pago -->
                <fieldset class="mb-4 p-3 border rounded">
                    <legend class="float-none w-auto px-2 fs-6 text-success">Método de Pago</legend>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="paymentMethod" id="paymentOnline" value="online" checked required>
                        <label class="form-check-label" for="paymentOnline">
                            <strong class="text-primary">Pago en línea</strong> (Tarjeta de crédito/débito)
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="paymentMethod" id="paymentStore" value="store" required>
                        <label class="form-check-label" for="paymentStore">
                            <strong class="text-secondary">Pago en tienda</strong> (Al momento de retirar)
                        </label>
                    </div>
                </fieldset>

                <!-- Información del Cliente -->
                <fieldset class="p-3 border rounded">
                    <legend class="float-none w-auto px-2 fs-6 text-success">Información Cliente</legend>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="clientName" class="form-label">Nombre Cliente</label>
                            <input type="text" class="form-control" id="clientName" name="clientName" required>
                        </div>
                        <div class="col-md-6">
                            <label for="clientRut" class="form-label">RUT</label>
                            <input type="text" class="form-control" id="clientRut" name="clientRut" placeholder="Ej: 12.345.678-9" required>
                        </div>
                        <div class="col-md-6">
                            <label for="clientEmail" class="form-label">Correo Electrónico</label>
                            <input type="email" class="form-control" id="clientEmail" name="clientEmail" required>
                        </div>
                        <div class="col-md-6">
                            <label for="clientPhone" class="form-label">Celular de Contacto</label>
                            <input type="tel" class="form-control" id="clientPhone" name="clientPhone" required>
                        </div>
                        <div class="col-12">
                            <label for="clientAddress" class="form-label">Ubicación (para boleta)</label>
                            <input type="text" class="form-control" id="clientAddress" name="clientAddress" placeholder="Calle, número, comuna/ciudad" required>
                            <div class="form-text">Ubicación solo para fines de boleta/facturación.</div>
                        </div>
                    </div>
                </fieldset>

                <!-- Botón Continuar Compra -->
                <div class="mt-3">
                    <button type="submit" class="btn btn-success w-100">
                        Continuar Compra &rarr;
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% block script %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('pedidoForm');

    form.addEventListener('submit', function(e) {
        if (!form.checkValidity()) {
            e.preventDefault();
            form.reportValidity();
        }
    });
});
</script>
{% endblock %}
